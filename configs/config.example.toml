# Brale 示例配置（整合 base.toml + config.toml，带中文注释）。
# 建议复制为 configs/config.toml 后按需调整；敏感字段需替换为自己的值。

[app]
env = "dev"                # 运行环境标识
log_level = "info"         # 日志级别：debug|info|warn|error
http_addr = ":9991"        # HTTP 监听地址
log_path = "/data/logs/brale-live.log"     # 主日志文件（同时输出 stdout）
llm_log_path = "/data/logs/brale-llm.log"  # LLM 请求/响应日志
llm_dump_payload = false                   # 如需记录完整 payload 可置为 true

[symbols]
provider = "default"        # 币种列表来源 default|http
default_list = ["ETHUSDT"]  # 监控交易对

[kline]
max_cached = 300            # 每个周期缓存的 K 线条数上限

[market]
active_source = "binance"   # 默认市场数据源
[[market.sources]]
name = "binance"
enabled = true
rest_base_url = "https://fapi.binance.com"
ws_base_url = "wss://fstream.binance.com/stream"
rate_limit_per_min = 1200
ws_batch_size = 150

[ai]
aggregation = "meta"                       # 决策聚合策略：meta/first 等
decision_log_path = "/data/live/decisions.db" # 决策日志 SQLite 路径
last_decision_max_age_seconds = 3600       # 上一轮决策缓存有效期
weights = { openai = 1.0, deepseek = 1.0, qwen = 1.0, vanchin = 1.0 }
log_each_model = true
include_last_decision = true               # 是否把上一轮决策作为上下文
decision_interval_seconds = 600            # 决策间隔秒数
active_horizon = "four_hour"               # 启用的持仓周期配置
provider_preference = ["qwen", "deepseek"] # 模型偏好顺序

[ai.profile_defaults]
analysis_slice = 99                        # 默认截取的历史根数
slice_drop_tail = 1                        # 默认丢弃的最新蜡烛数量

[ai.profile_defaults.indicators.ema]
fast = 7
mid = 25
slow = 99
[ai.profile_defaults.indicators.rsi]
period = 14
oversold = 33
overbought = 68

[ai.holding_horizon_profiles.one_hour]
entry_timeframes = ["5m", "15m"]
confirm_timeframes = ["1h"]
background_timeframes = ["4h"]
slice_drop_tail = 1
[ai.holding_horizon_profiles.one_hour.indicators.rsi]
oversold = 30
overbought = 70

[ai.holding_horizon_profiles.four_hour]
entry_timeframes = ["30m", "1h"]
confirm_timeframes = ["4h"]
background_timeframes = ["1d"]
[ai.holding_horizon_profiles.four_hour.indicators.rsi]
oversold = 35
overbought = 65

[ai.holding_horizon_profiles.one_day]
entry_timeframes = ["1h"]
confirm_timeframes = ["4h", "1d"]
background_timeframes = ["1w"]
[ai.holding_horizon_profiles.one_day.indicators.rsi]
oversold = 35
overbought = 65

[ai.holding_horizon_profiles.quant_agent]
entry_timeframes = ["1h"]
confirm_timeframes = ["4h", "1d"]
background_timeframes = ["1w"]
slice_drop_tail = 1
[ai.holding_horizon_profiles.quant_agent.indicators.rsi]
oversold = 35
overbought = 65

[ai.multi_agent]
enabled = true
indicator_template = "agent_indicator" # 对应 prompts/agent_indicator.txt
pattern_template = "agent_pattern"
trend_template = "agent_trend"
max_blocks = 4
indicator_provider = "deepseek"        # 可指定固定模型，留空则按偏好顺序
pattern_provider = "qwen"
trend_provider = "vanchin"

[prompt]
dir = "prompts"
system_template = "prompt_default"

[notify.telegram]
enabled = true
bot_token = "REPLACE_ME"   # 必填：你的 Telegram Bot Token
chat_id = "REPLACE_ME"     # 必填：你的 Chat ID

[freqtrade]
enabled = true
api_url = "http://freqtrade:8080/api/v1"  # freqtrade API 地址
username = "REPLACE_ME"                   # freqtrade Basic 用户名（或留空用 api_token）
password = "REPLACE_ME"                   # freqtrade Basic 密码
api_token = ""                            # freqtrade API Token（可选）
default_stake_usd = 100                   # 缺省下单金额（USDT）
default_leverage = 1                      # 缺省杠杆
timeout_seconds = 15
insecure_skip_verify = false
webhook_url = "http://brale:9991/api/live/freqtrade/webhook"
risk_store_path = "/data/db/trade_risk.db"
min_stop_distance_pct = 0.005             # 开仓验证时的最小止损距离（比例）

[advanced]
liquidity_filter_usd_m = 15
min_risk_reward = 1
open_cooldown_seconds = 180
max_opens_per_cycle = 3
tier_min_distance_pct = 0.005

[trading]
mode = "static"               # 资金模式（当前仅 static）
max_position_pct = 0.01       # 单笔最大仓位占比
default_position_usd = 0      # 固定仓位金额；0 表示按占比推导
default_leverage = 10         # 默认杠杆（模型未提供时）

[[ai.models]]
id = "deepseek"
provider = "deepseek"
enabled = true
api_url = "https://api.qnaigc.com/v1"
api_key = "REPLACE_ME"
model = ""
supports_vision = false
expect_json = false

[[ai.models]]
id = "qwen"
provider = "qwen"
enabled = true
api_url = "https://api.qnaigc.com/v1"
api_key = "REPLACE_ME"
model = ""
supports_vision = false
expect_json = false

